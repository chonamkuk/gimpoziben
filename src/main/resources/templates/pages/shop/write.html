<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="../layout/default">

<!-- page CSS -->
<th:block layout:fragment="css">
    <style>
        i {
            vertical-align: middle;
        }

        .carousel {
            height: 587px;
            border: 1px solid #ECEFF1;
        }

        .carousel .carousel-item > img {
            top: 50%;
            -webkit-transform: translate(0,-50%);
            transform: translate(0,-50%);
            position: relative;
            width: auto;
            max-height: 100%;
            -webkit-transition: border-color .15s linear;
            transition: border-color .15s linear;
        }

        .carousel .indicators .indicator-item {
            border: 1px solid #bababa;
            width: 15px;
            height: 15px;
        }

        .dropify-wrapper {
            padding: 0px;
        }
        div.dropify-preview > div > div > p {
            top: 15px;
        }

        .img-field {
            padding: 0 0.75rem;
        }
    </style>
</th:block>

<!-- page 스크립트 -->
<th:block layout:fragment="script">
    <script>
        $(document).ready(function(){
            CKEDITOR.replace('descProduct');

            let processed = false;
            $('#saveForm').submit(function(e){
                if(!processed) {
                    if(e.preventDefault) {
                        e.preventDefault();
                    }
                } else {
                    e.returnValue = false;
                }

                $('#confirmModal').find('h4').text('알림');
                $('#confirmModal').find('p').text('등록 하시겠습니까?');
                $('#confirmModal').find('.confirm').on('click', function(){
                    processed = true;
                    $('#saveForm').submit();
                })
                $('#confirmModal').modal('open');
            });

            $('.carousel.carousel-slider').carousel({
                fullWidth: true,
                indicators: true
            });

            let carousel = M.Carousel.getInstance($('.carousel.carousel-slider'));

            // 첨부파일 모듈
            let drEvent = $('.dropify').dropify({
                messages: {
                    'default': '상품사진',
                    'replace': '',
                    'remove':  '삭제',
                    'error':   'error'
                },
                tpl: {
                    wrap:            '<div class="dropify-wrapper"></div>',
                    loader:          '<div class="dropify-loader"></div>',
                    message:         '<div class="dropify-message"><p>{{ default }}</p></div>',
                    preview:         '<div class="dropify-preview"><span class="dropify-render"></span><div class="dropify-infos"><div class="dropify-infos-inner"></div></div></div>',
                    filename:        '<p class="dropify-filename"><span class="file-icon"></span><span class="dropify-filename-inner"></span></p>',
                    clearButton:     '<button type="button" class="dropify-clear">{{ remove }}</button>',
                    errorLine:       '<p class="dropify-error">{{ error }}</p>',
                    errorsContainer: ''
                }
            });

            // 파일확장자 에러메세지
            drEvent.on('dropify.error.fileExtension', function(event, element){
                alert('이미지 파일만 업로드 가능합니다. (' + event.currentTarget.dataset.allowedFileExtensions + ')');
            });
            // 첨부파일 삭제 전 동작
            drEvent.on('dropify.beforeClear', function(event, element){
                return confirm("\"" + element.file.name + "\" 파일을 삭제하시겠습니까?");
            });
            // 첨부파일 삭제 후 동작
            drEvent.on('dropify.afterClear', function(event, element){
                let targetIndex = $(event.target).data('index');
                $('.carousel-item img').eq(targetIndex).attr('src', '');
            });
            // 첨부파일 로딩 후 동작
            drEvent.on('dropify.fileReady', function(event, element){
                setTimeout(function(){
                    let targetIndex = $(event.target).data('index');
                    $('.carousel-item img').eq(targetIndex).attr('src', $('.dropify-render').eq(targetIndex).find('img').attr('src'));
                    carousel.set(targetIndex);
                }, 200); // 이미지소스 생성시간
            });

            $('[name="group1"]').on('click', function(e){
                $('[name="seqSize"]').attr('disabled', true);
                $('[name="seqSize"]').each(function(index, item){
                    $(item).prop('checked', false);
                });
                $(this).parents('td').siblings('td').find('[name="seqSize"]').attr('disabled', false);
                $(this).parents('td').siblings('td').find('[name="seqSize"]').each(function(index, item){
                    $(item).prop('checked', true);
                });
            });
        });
    </script>
</th:block>

<div layout:fragment="content" >
    <div class="col s12">
        <div class="container">
            <!-- section start -->
            <div class="section">
                <div class="card">
                    <div class="card-content">
                        <div class="row">
                            <div class="col s12">
                                <!-- form start -->
                                <form id="saveForm" action="/admin/shop/write.do" method="post">
                                    <div class="row">
                                        <!-- 이미지 슬라이더 -->
                                        <div class="col s12 m6">
                                            <div class="row">
                                                <div class="carousel carousel-slider center" data-indicators="true">
                                                    <div class="carousel-item white-text">
                                                        <img src="" class="responsive-img" alt="">
                                                    </div>
                                                    <div class="carousel-item white-text">
                                                        <img src="" class="responsive-img" alt="">
                                                    </div>
                                                    <div class="carousel-item white-text">
                                                        <img src="" class="responsive-img" alt="">
                                                    </div>
                                                    <div class="carousel-item white-text">
                                                        <img src="" class="responsive-img" alt="">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- input 영역 -->
                                        <div class="col s12 m6">
                                            <div class="row">
                                                <div class="col s12 input-field">
                                                    <input id="titleProduct" name="titleProduct" type="text" class="validate" required>
                                                    <label for="titleProduct">타이틀</label>
                                                    <small class="errorTxt5"></small>
                                                </div>
                                                <div class="col s12 input-field">
                                                    <input id="nmProduct" name="nmProduct" type="text" class="validate" required>
                                                    <label for="nmProduct">모델명</label>
                                                    <small class="errorTxt5"></small>
                                                </div>
                                                <div class="col s12 input-field">
                                                    <input id="colorProduct" name="colorProduct" type="text" class="validate">
                                                    <label for="colorProduct">색상</label>
                                                    <small class="errorTxt5"></small>
                                                </div>
                                                <div class="col s6 input-field">
                                                    <input id="buyPrice" name="buyPrice" type="number" class="validate">
                                                    <label for="buyPrice">매입가격</label>
                                                </div>
                                                <div class="col s6 input-field">
                                                    <input id="sellPrice" name="sellPrice" type="number" class="validate">
                                                    <label for="sellPrice">판매가격</label>
                                                </div>
                                                <div class="col s6 input-field">
                                                    <div class="m-0">
                                                        <span>상품 게시여부</span>
                                                        <div class="switch right">
                                                            <label>
                                                                <input checked type="checkbox"/>
                                                                <span class="lever"></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col s6 input-field">
                                                    <div class="m-0">
                                                        <span>품절여부</span>
                                                        <div class="switch right">
                                                            <label>
                                                                <input type="checkbox"/>
                                                                <span class="lever"></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col s3 m3 l3 input-field img-field">
                                                    <input type="file" id="input-file-now1" class="dropify" data-height="100" data-allowed-file-extensions="png jpg jpeg gif bmp" data-index="0"/>
                                                </div>
                                                <div class="col s3 m3 l3 input-field img-field">
                                                    <input type="file" id="input-file-now2" class="dropify" data-height="100" data-allowed-file-extensions="png jpg jpeg gif bmp" data-index="1"/>
                                                </div>
                                                <div class="col s3 m3 l3 input-field img-field">
                                                    <input type="file" id="input-file-now3" class="dropify" data-height="100" data-allowed-file-extensions="png jpg jpeg gif bmp" data-index="2"/>
                                                </div>
                                                <div class="col s3 m3 l3 input-field img-field">
                                                    <input type="file" id="input-file-now4" class="dropify" data-height="100" data-allowed-file-extensions="png jpg jpeg gif bmp" data-index="3"/>
                                                </div>
                                                <div class="col s12 input-field">
                                                    <button type="button" class="btn indigo modal-trigger" href="#sizeModal">사이즈 타입 선택</button>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- 에디터 영역 -->
                                        <div class="col s12">
                                            <div class="input-field">
                                                <textarea name="descProduct"></textarea>
                                            </div>
                                        </div>
                                        <!-- 사이즈선택 모달 -->
                                        <div id="sizeModal" class="modal">
                                            <div class="modal-content">
                                                <i class="material-icons modal-close" style="float: right;">close</i>
                                                <h4>사이즈 타입 선택</h4>
                                                <div class="col s12">
                                                    <table class="mt-1">
                                                        <thead>
                                                        <tr>
                                                            <th>사이즈 종류</th>
                                                            <th colspan="100%" style="text-align: center;">사이즈 선택</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                        <tr>
                                                            <td>
                                                                <p class="mb-1">
                                                                    <label>
                                                                        <input name="group1" type="radio" />
                                                                        <span>타입1</span>
                                                                    </label>
                                                                </p>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>95</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>100</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>105</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>110</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>115</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>120</span>
                                                                </label>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <p class="mb-1">
                                                                    <label>
                                                                        <input name="group1" type="radio" />
                                                                        <span>타입2</span>
                                                                    </label>
                                                                </p>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>30</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>32</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>34</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>36</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>38</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>40</span>
                                                                </label>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <p class="mb-1">
                                                                    <label>
                                                                        <input name="group1" type="radio" />
                                                                        <span>타입3</span>
                                                                    </label>
                                                                </p>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>250</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>260</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>270</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>280</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>290</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>300</span>
                                                                </label>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <p class="mb-1">
                                                                    <label>
                                                                        <input name="group1" type="radio" />
                                                                        <span>타입4</span>
                                                                    </label>
                                                                </p>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>S</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>M</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>L</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>XL</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>2XL</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>3XL</span>
                                                                </label>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <p class="mb-1">
                                                                    <label>
                                                                        <input name="group1" type="radio" />
                                                                        <span>타입5</span>
                                                                    </label>
                                                                </p>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>소형</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>중형</span>
                                                                </label>
                                                            </td>
                                                            <td>
                                                                <label>
                                                                    <input type="checkbox" name="seqSize"/>
                                                                    <span>대형</span>
                                                                </label>
                                                            </td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                    <!-- </div> -->
                                                </div>
                                            </div>
                                        </div>
                                        <!-- 버튼 영역 -->
                                        <div class="col s12 display-flex justify-content-end mt-1">
                                            <button type="submit" class="btn indigo" style="margin-right: 1rem;">등록</button>
                                            <button type="button" class="btn btn-light">취소</button>
                                        </div>
                                    </div>
                                </form>
                                <!-- form ends -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- section edit ends -->
        </div>
    </div>

    <!--
    <form id="saveForm" action="/shop/write.do" method="post">
        <div class="input-field col s12">
            <input type="text" id="nmProduct" name="nmProduct" required="" maxlength="20">
            <label for="nmProduct">제품명</label>
        </div>
        <div class="input-field col s12">
            <input type="text" id="sizeProduct" name="sizeProduct" maxlength="100">
            <label for="sizeProduct">제품색상</label>
        </div>
        <div class="row">
            <div class="input-field col m6 s12">
                <input type="number" id="buyPrice" name="buyPrice">
                <label for="buyPrice">매입가격</label>
            </div>
            <div class="input-field col m6 s12">
                <input type="number" id="sellPrice" name="sellPrice">
                <label for="sellPrice">판매가격</label>
            </div>
        </div>
        <div class="row">
            <div class="input-field col m6 s12">
                <div class="switch">
                    <label>
                        숨김
                        <input type="checkbox" name="ynDisplay" id="ynDisplay" checked>
                        <span class="lever"></span>
                        게시
                    </label>
                </div>
            </div>
            <div class="input-field col m6 s12">
                <div class="switch">
                    <label>
                        품절
                        <input type="checkbox" name="ynSoldout" id="ynSoldout" checked>
                        <span class="lever"></span>
                        재고있음
                    </label>
                </div>
            </div>
        </div>
        <div>
            <textarea name="descProduct"></textarea><br>
        </div>
        <div class="img-container">
            <div class="large-slide">
                <div id="numbertext" class="numbertext"></div>
            </div>

            <div class="img-row">
                <div class="column">
                </div>
                <div class="column">
                </div>
                <div class="column">
                </div>
                <div class="column">
                </div>
                <div class="column">
                </div>
                <div class="column">
                </div>
            </div>
        </div>
            <input type="file" id="img-input" class="img-input" multiple accept="image/*" style="display: none;"/>

        <a class="waves-effect waves-light btn-small" id="submitBtn">등록</a>
    </form>
    -->
</div>
</html>
